#define LED_PIN 8
#define BUTTON_PIN 7
#include<Servo.h>
#define servoPin  9 // Arduino pin connected to Servo Motor's pin

Servo Myservo;
int pos=90;
long offAt=0;
long offAtservo=2147483647;
bool IsClose= true;
int angle = 0;
int speed = 0;
bool Direction = true; 



#include <Wire.h> 
#include <LiquidCrystal_I2C.h>


LiquidCrystal_I2C lcd(0x27, 16,2); 


// constants won't change

#define TRIG_PIN   12  // Arduino pin connected to Ultrasonic Sensor's TRIG pin
#define ECHO_PIN   11 // Arduino pin connected to Ultrasonic Sensor's ECHO pin
const int DISTANCE_THRESHOLD  = 10; // centimeters
// variables will change:
long duration_us, distance_cm;



void setup() {
   Serial.begin (9600);       // initialize serial port
  pinMode(LED_PIN, OUTPUT);
  pinMode(BUTTON_PIN, INPUT);
  pinMode(TRIG_PIN, OUTPUT); // set arduino pin to output mode
  pinMode(ECHO_PIN, INPUT);  // set arduino pin to input mode
  Myservo.attach(servoPin);
  lcd.init();
  lcd.begin(16,2);
  lcd.backlight();
  
}




void loop() {


  
  if( (digitalRead(LED_PIN) == LOW ) && (digitalRead(BUTTON_PIN) == LOW) ) //if LED is off  and button is pressed [low because it has pullup resistor]
  { 
    digitalWrite(LED_PIN, HIGH);
    offAt = millis() + 1000; //store var of now + 3 seconds
    lcd.print("WELCOME!!!!!!!!");
   
  }
  
  if(digitalRead(LED_PIN) == HIGH) //if led is on
  {
      if(millis() >= offAt) //see if it's time to turn off LED
      {
         digitalWrite(LED_PIN, LOW); //it's time. this also re-enables the button
          lcd.clear();
        
      }
  }
    if(digitalRead(BUTTON_PIN) == LOW){
     Direction=!Direction;
   }
if (digitalRead(BUTTON_PIN) == LOW &&  (IsClose==true) && millis() <= offAtservo  ) {
    offAtservo = millis() + 1000; //store var of now + 90 DEGREES
     IsClose=false; 
  }
    if (millis() <= offAtservo && !IsClose ){
        if (Direction){  
        Myservo.write(180);  
     }
     else
     Myservo.write(0); 
    }
     else {
       Myservo.write(90);  
      
       IsClose=true;
       offAtservo = 2147483647;
     }



  // generate 10-microsecond pulse to TRIG pin
  digitalWrite(TRIG_PIN, LOW);
  delayMicroseconds(2);
  digitalWrite(TRIG_PIN, HIGH);
  delayMicroseconds(10);
 digitalWrite(TRIG_PIN, LOW);

  // measure duration of pulse from ECHO pin
  duration_us = pulseIn(ECHO_PIN, HIGH);
  // calculate the distance
  distance_cm = duration_us*0.017;

  if(distance_cm>10)
  {
  //  Myservo.write(90); // rotate servo motor to 90 degree
    digitalWrite(10, LOW);
   
  }
  else
  
  {
    digitalWrite(10, HIGH);
   }

  // print the value to Serial Monitor
  Serial.print("distance: ");
  Serial.print(Direction);
  Serial.println(" cm");
   
}